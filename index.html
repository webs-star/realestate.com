<!DOCTYPE html>
<html>
<head>
  <title>Real Estate Marketplace</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Google Site Verification -->
  <meta name="google-site-verification" content="ZuK2pvozDS96vm0_IRjSYEsTqSdC8FJCIgJdAitGf0U" />
  <!-- SEO Metadata -->
  <meta name="description" content="Use the RealPlot customer map to discover land and rental properties in Kenya. Apply filters and get voice-guided directions instantly." />
  <meta name="keywords" content="real estate Kenya, land map Kenya, property listings, rentals, voice directions, RealPlot Connect, property map" />
  <meta name="author" content="RealPlot Connect by Webs Star" />
  <meta name="robots" content="index, follow" />
  <!-- Open Graph Meta -->
  <meta property="og:title" content="RealPlot Connect ‚Äì Customer Property Finder" />
  <meta property="og:description" content="Discover land, rentals, and houses near you using RealPlot‚Äôs live map. Voice-guided directions and filtering included." />
  <meta property="og:url" content="https://webs-star.github.io/realestate.com/customers.html" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://your-site-preview-image.jpg" />
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f4f4;
      padding: 20px;
      color: #333;
    }
    h2 {
      text-align: center;
      margin-top: 30px;
      font-size: 24px;
      color: #2c3e50;
    }
    form, .card, .filters, .ownerLogin {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      max-width: 900px;
      margin: 20px auto;
    }
    input, textarea, select, button {
      width: 100%;
      margin-top: 10px;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #2980b9;
    }
    button {
      background-color: #3498db;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    #previewContainer img {
      width: 100px;
      margin: 5px;
      border-radius: 5px;
      object-fit: cover;
      height: 80px;
    }
    img.property {
      width: 100%;
      margin-bottom: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #listings {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      padding: 10px;
    }
    .card button {
      margin-top: 10px;
    }
    .directions-text {
      margin-top: 10px;
      background: #eef9ff;
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
      color: #2c3e50;
      white-space: pre-wrap;
    }
	
	
	
	.note-box {
  background: #fff7e6;
  border-left: 6px solid #ffa500;
  padding: 15px 20px;
  margin: 20px 0;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  animation: fadeIn 1s ease-in-out;
}

.note-box h3 {
  margin-top: 0;
  color: #d35400;
  font-size: 1.2rem;
}

.note-box ul {
  padding-left: 1.2em;
}

.note-box li {
  margin-bottom: 8px;
}

	
	
	
	
	
	
  </style>
</head>

<div class="note-box">
  <h3>üè† RealPlot Connect ‚Äì Kenya Property Listings</h3>
  <p><strong>NOTE:</strong></p>
  <ul>
    <li>1. Only list your property when you are very close to the property, since the map will save that location.</li>
    <li>2. After the property is sold or leased, remember to delete the property to avoid unnecessary confusions.</li>
    <li>3. Countercheck your listing on the map to see whether it displays correct information; if incorrect, edit.</li>
  </ul>
</div>




<body>





<!-- Upload Form -->
<h2>üì§ Upload Property Listing</h2>
<form id="uploadForm">
  
 
  
  <select id="type" required>
    <option value="">Select Property Type</option>
    <option value="land">Land / Plots</option>
    <option value="house">House</option>
    <option value="apartment">Apartment / Flat</option>
    <option value="bungalow">Bungalow</option>
    <option value="maisonette">Maisonette</option>
    <option value="bedsitter">Bedsitter</option>
    <option value="single room">Single Room</option>
    <option value="shop">Shop / Stall</option>
    <option value="office">Office Space</option>
    <option value="godown">Godown / Warehouse</option>
    <option value="commercial building">Commercial Building</option>
    <option value="leased">Leased Property</option>
    <option value="rental">Rental Unit</option>
    <option value="hostel">Student Hostel</option>
    <option value="farm">Farm Land</option>
    <option value="vacant land">Vacant Land</option>
    <option value="industrial">Industrial Property</option>
    <option value="resort">Resort / Hotel</option>
  </select>
  <input type="text" id="location" placeholder="Location (County, Sub-county, Town)" required />
  <input type="number" id="price" placeholder="Price (KES)" required />
  
  <input type="tel" id="contact" placeholder="Phone number" required />
  <textarea id="description" placeholder="Description"></textarea>
  <input type="file" id="images" accept="image/*" multiple required />
  <div id="previewContainer" style="display:flex; flex-wrap:wrap;"></div>
  <div id="loading" style="display:none; text-align:center; font-weight:bold;">‚è≥ Uploading, please wait...</div>
  <button type="submit">Submit</button>
</form>

<!-- All Listings -->
<h2>üè† All Listings</h2>
<div id="listings"></div>

<script>
   const firebaseConfig = {
    apiKey: "AIzaSyDLTAd2u0IlhA4Gm4-0tTSzLUDHFYj045g",
    authDomain: "realestate-afbe6.firebaseapp.com",
    databaseURL: "https://realestate-afbe6-default-rtdb.firebaseio.com",
    projectId: "realestate-afbe6",
    storageBucket: "realestate-afbe6.appspot.com",
    messagingSenderId: "202970291965",
    appId: "1:202970291965:web:baaf253d6c9a8685c5e894"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Cloudinary setup
  const cloudName = "dwvt4e9o2";
  const uploadPreset = "unsigned_upload";

  // Grab form elements
  const form = document.getElementById("uploadForm");
  const imageInput = document.getElementById("images");
  const previewContainer = document.getElementById("previewContainer");
  const loading = document.getElementById("loading");

  let imageURLs = [], isSubmitting = false;
  let currentUserLatLng = null;

  // Preview images
  imageInput.addEventListener("change", () => {
    previewContainer.innerHTML = "";
    imageURLs = [];
    [...imageInput.files].forEach(file => {
      const img = document.createElement("img");
      img.src = URL.createObjectURL(file);
      previewContainer.appendChild(img);
    });
  });

  // Get user location at startup
  navigator.geolocation.getCurrentPosition(
    pos => currentUserLatLng = L.latLng(pos.coords.latitude, pos.coords.longitude),
    () => console.warn("Geolocation access denied.")
  );

  // Handle form submit
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    if (isSubmitting) return;
    isSubmitting = true;
    loading.style.display = "block";

    const files = [...imageInput.files];
    imageURLs = [];

    try {
      // Upload to Cloudinary
      for (const file of files) {
        const formData = new FormData();
        formData.append("file", file);
        formData.append("upload_preset", uploadPreset);
        formData.append("folder", "listings");
        const res = await axios.post(`https://api.cloudinary.com/v1_1/${cloudName}/image/upload`, formData);
        imageURLs.push(res.data.secure_url);
      }

      // Attempt geolocation on submit
      let lat = null, lng = null;
      try {
        const pos = await new Promise((res, rej) => 
          navigator.geolocation.getCurrentPosition(res, rej)
        );
        lat = pos.coords.latitude;
        lng = pos.coords.longitude;
      } catch {}

      // Build object
      const property = {
        type: document.getElementById("type").value,
        location: document.getElementById("location").value,
        price: parseInt(document.getElementById("price").value),
        contact: document.getElementById("contact").value,
        description: document.getElementById("description").value,
        images: imageURLs,
        lat, lng,
        timestamp: Date.now()
      };

      await db.ref("listings").push(property);
      alert("‚úÖ Uploaded!");
      form.reset();
      previewContainer.innerHTML = "";
      loadListings();
    } catch(err) {
      console.error(err);
      alert("‚ùå Upload failed");
    } finally {
      loading.style.display = "none";
      isSubmitting = false;
    }
  });

  // Load and render listings
  function loadListings() {
    const filterType = document.getElementById("filterType").value;
    const filterLocation = document.getElementById("filterLocation").value;
    const minPrice = parseInt(document.getElementById("minPrice").value) || 0;
    const maxPrice = parseInt(document.getElementById("maxPrice").value) || Infinity;

    db.ref("listings").once("value", snapshot => {
      const data = snapshot.val() || {};
      const listingsDiv = document.getElementById("listings");
      listingsDiv.innerHTML = "";

      for (let id in data) {
        const item = data[id];
        if (
          (filterType && item.type !== filterType) ||
          (filterLocation && !item.location.toLowerCase().includes(filterLocation.toLowerCase())) ||
          (item.price < minPrice || item.price > maxPrice)
        ) continue;

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <p><strong>Type:</strong> ${item.type}</p>
          <p><strong>Location:</strong> ${item.location}</p>
          <p><strong>Price:</strong> KES ${item.price}</p>
          <p>${item.description}</p>
          <p><strong>Contact:</strong> ${item.contact}</p>
        `;

        (item.images || []).forEach(url => {
          const img = document.createElement("img");
          img.src = url;
          img.className = "property";
          card.appendChild(img);
        });

        if (item.lat != null && item.lng != null) {
          const mapContainerId = `map-${id}`;
          const mapBtn = document.createElement("button");
          mapBtn.textContent = "üìç Show Directions";
          mapBtn.onclick = () => showMapForListing(item.lat, item.lng, mapContainerId);
          const mapDiv = document.createElement("div");
          mapDiv.id = mapContainerId;
          mapDiv.style.marginTop = "10px";
          card.appendChild(mapBtn);
          card.appendChild(mapDiv);
        }

        listingsDiv.appendChild(card);
      }
    });
  }

  // Show map and routing
  function showMapForListing(destLat, destLng, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    const mapDiv = document.createElement("div");
    mapDiv.style.height = "300px";
    mapDiv.style.borderRadius = "10px";
    container.appendChild(mapDiv);

    const map = L.map(mapDiv).setView([destLat, destLng], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    L.Routing.control({
      waypoints: [
        currentUserLatLng || L.latLng(destLat - 0.01, destLng - 0.01),
        L.latLng(destLat, destLng)
      ],
      routeWhileDragging: false,
      collapsible: true
    }).addTo(map);
  }

  window.onload = loadListings;
</script>

</body>
</html>
